= Build
Martin Langlotz <martin.langlotz@evilbrain.de>
:source-highlighter: highlightjs
:toc:
:icons: font

== mgtt

Of course, a go-compiler is needed

```bash
cd mgtt
go mod vendor
CGO_ENABLED=0 GOOS=linux go build -a -ldflags '-extldflags "-static"' -o mgtt .
```

Then you can use mgtt

```bash
./mgtt -h

Usage: mgtt

Message Go Telemetry Transport

Flags:
  -h, --help                         Show context-sensitive help.
  -v, --debug                        Enable debug mode ($DEBUG).
      --terminal                     Enable terminal mode ( log not printed as json) ($TERMINAL)
      --config-path="./"             Path where config files are stored. This can be used by plugins ($CONFIGPATH)
      --url="tcp://0.0.0.0:8883"     Set the url where the broker is listening ($URL)
      --cert-file="cert.pem"         The certificate to use for TLS. If not set, TLS is disabled ($CERT)
      --key-file="key.pem"           The private key to use for TLS ($KEY)
      --db-filename="messages.db"    Filename for retained message-db ($DBFILENAME)
      --connect-timeout=30           Timeout in seconds for CONNECT. If an client don't send a connect after this time, it will be disconnected ($CONNECT_TIMEOUT)
```

== Docker-Image

You can build the docker image with docker-compose

```bash
docker-compose build
```

== Assets for documentation

```bash
cd assets
yarn add -s @mermaid-js/mermaid-cli
./node_modules/.bin/mmdc -p puppeteer-config.json -i QoS2.mmd -o QoS2.png
```
